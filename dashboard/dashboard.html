<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@200;300;400;500;600;700;800&family=Montserrat:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0"
    />
    <link rel="stylesheet" href="../css/style.css" />
    <link
      rel="shortcut icon"
      href="../assets/images/logo-color.svg"
      type="image/x-icon"
    />
    <title>My Brand</title>
  </head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
  <body>
    <div class="dashboard-container">
      <div class="error-container" id="error-container">
        <span class="material-symbols-outlined" id="error-icon"> error </span>
        <p id="error-text" class="error-text"></p>
      </div>
      <div class="success-container" id="success-container">
        <span class="material-symbols-outlined" id="error-icon">
          check_circle
        </span>
        <p id="success-text" class="success-text"></p>
      </div>
      <aside class="dashboard-sidebar" id="dashboard-sidebar">
        <a href="../index.html" class="dashboard-image-logo">
          <img src="../assets/images/logo.png" alt="logo" />
        </a>

        <div class="dashboard-links-container">
          <button class="button burger-close" id="burger-close">X</button>
          <a
            href="./dashboard.html"
            class="rounded-text grey-text category-tag dashboard-link"
            id="active-dashboard-link"
          >
            <img
              src="../assets//images//dashboard-icons/dashboard.svg"
              alt=""
            />
            <p>Dashboard</p>
          </a>
          <a
            href="./dashboard-articles.html"
            class="rounded-text grey-text category-tag dashboard-link"
          >
            <img src="../assets//images//dashboard-icons/articles.svg" alt="" />
            <p>Articles</p>
          </a>
          <a
            href="./dashboard-messages.html"
            class="rounded-text grey-text category-tag dashboard-link"
          >
            <img src="../assets//images//dashboard-icons/messages.svg" alt="" />
            <p>Messages</p>
          </a>
          <a
            href="./dashboard-users.html"
            class="rounded-text grey-text category-tag dashboard-link"
          >
            <img src="../assets//images//dashboard-icons/users.svg" alt="" />
            <p>Users</p>
          </a>
          <a
            href="./dashboard-projects.html"
            class="rounded-text grey-text category-tag dashboard-link"
          >
            <img src="../assets//images//dashboard-icons/projects.svg" alt="" />
            <p>Projects</p>
          </a>
          <a
            href="./dashboard-tesimonial.html"
            class="rounded-text grey-text category-tag dashboard-link"
          >
            <img
              src="../assets//images//dashboard-icons/testimonial.svg"
              alt=""
            />
            <p>Testimonials</p>
          </a>
        </div>
        <button
          class="rounded-text grey-text category-tag dashboard-link dashboard-logout"
          id="logout-button"
        >
          <p>Logout</p>
          <img src="../assets//images//dashboard-icons/logout.svg" alt="" />
        </button>
      </aside>

      <div class="dashboard-content-container">
        <div class="dashboard-header">
          <div class="dashboard-menu-search">
            <div class="burger" id="dashboard-burger">
              <div class="burger-line burger-line1"></div>
              <div class="burger-line burger-line2"></div>
              <div class="burger-line burger-line3"></div>
            </div>

            <div class="input-for search-form">
              <input
                type="search"
                name="email"
                id="email"
                placeholder="Enter Your Email"
              />
              <span class="material-symbols-outlined"> search </span>
            </div>
          </div>

          <div class="dashboard-user-info">
            <img
              src="../assets/images/my-avatar.svg"
              alt="avatar"
              class="avatar"
            />
            <div>
              <p class="white-text small-text title">Angelo Christian</p>
              <p class="grey-text small-text">Admin</p>
            </div>
          </div>
        </div>

        <script>
          const dashboardBurger = document.getElementById("dashboard-burger");
          const burgerClose = document.getElementById("burger-close");
          const dashboardSidebar = document.getElementById("dashboard-sidebar");

          dashboardBurger.addEventListener("click", () => {
            dashboardSidebar.style.transform = "translateX(0%)";
          });

          burgerClose.addEventListener("click", () => {
            dashboardSidebar.style.transform = "translateX(-130%)";
          });
        </script>
        <div class="dashboard-content">
          <div class="dashboard-tags-container">
            <div class="dashboard-tag">
              <img src="../assets/images/dashboard-icons/articles.svg" alt="" />
              <div>
                <p class="title white-text">Total Articles</p>
                <p class="title grey-text big-text" id="totalArticles">20</p>
              </div>
            </div>
            <div class="dashboard-tag">
              <img src="../assets/images/dashboard-icons/messages.svg" alt="" />
              <div>
                <p class="title white-text">Total Messages</p>
                <p class="title grey-text big-text" id="totalMessages">13</p>
              </div>
            </div>
            <div class="dashboard-tag">
              <img src="../assets/images/dashboard-icons/users.svg" alt="" />
              <div>
                <p class="title white-text">Total Users</p>
                <p class="title grey-text big-text" id="totalUsers">54</p>
              </div>
            </div>
            <div class="dashboard-tag">
              <img src="../assets/images/dashboard-icons/heart.svg" alt="" />
              <div>
                <p class="title white-text">Total Likes</p>
                <p class="title grey-text big-text" id="totalLikes">20</p>
              </div>
            </div>
          </div>
          <div class="dashboard-data-container">
            <div class="dashboard-graph">
              <canvas id="myChart" style="width: 100%"></canvas>

              <script>
                const xValues = [100, 200, 300, 400, 500, 600, 700, 800];

                new Chart("myChart", {
                  type: "line",
                  title: {
                    text: "Growth in Internet Users Globally",
                  },
                  data: {
                    labels: xValues,
                    datasets: [
                      {
                        data: [860, 1140, 1060, 1060, 1070, 1110, 1330, 2210],
                        borderColor: "red",
                        fill: false,
                      },
                      {
                        data: [1600, 1700, 1700, 1900, 2000, 2700, 4000, 5000],
                        borderColor: "green",
                        fill: false,
                      },
                      {
                        data: [300, 700, 2000, 5000, 6000, 4000, 2000, 1000],
                        borderColor: "blue",
                        fill: false,
                      },
                    ],
                  },
                  options: {
                    legend: { display: false },
                  },
                });
              </script>
            </div>
            <div class="dashboard-blog-container">
              <div class="dashboard-blog-container-upper">
                <p class="title white-text small-text">Recent Articles</p>

                <a
                  href="./dashboard-add-blog.html"
                  class="white-text rounded-text category-tag small-text"
                  >+ Add New</a
                >
              </div>
              <div
                class="dashboard-blog-container-map"
                id="dashboard-blog-container-map"
              >
                <div class="dashboard-blog-container-card">
                  <img
                    src="../assets//images//deepmind.webp"
                    alt="image"
                    class="blog-card-image"
                  />
                  <div class="blog-card-details">
                    <p class="title small-text blog-title">
                      ChatGPT : A Developer's Best Friend or Worst Enemy?
                    </p>
                    <div class="views-likes-comments">
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/eye.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">12 views</p>
                      </div>
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/heart.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">12 likes</p>
                      </div>
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/comment.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">12 comments</p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="dashboard-blog-container-card">
                  <img
                    src="../assets//images//deepmind.webp"
                    alt="image"
                    class="blog-card-image"
                  />
                  <div class="blog-card-details">
                    <p class="title small-text blog-title">
                      ChatGPT : A Developer's Best Friend or Worst Enemy?
                    </p>
                    <div class="views-likes-comments">
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/eye.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">12 views</p>
                      </div>
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/heart.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">12 likes</p>
                      </div>
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/comment.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">12 comments</p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="dashboard-blog-container-card">
                  <img
                    src="../assets//images//deepmind.webp"
                    alt="image"
                    class="blog-card-image"
                  />
                  <div class="blog-card-details">
                    <p class="title small-text blog-title">
                      ChatGPT : A Developer's Best Friend or Worst Enemy?
                    </p>
                    <div class="views-likes-comments">
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/eye.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">12 views</p>
                      </div>
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/heart.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">12 likes</p>
                      </div>
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/comment.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">12 comments</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="../Js/dashboard.js"></script>
    <script src="../Js/alert.js"></script>
    <script>
      const logoutButton = document.getElementById("logout-button");


      if (!loggedUser || loggedUser.role != "admin") {
        window.location.href = "../index.html";
      } else {
        // (successContainer.style.display = "flex"),
        //   (successElement.innerHTML = `Welcome, ${
        //     loggedUser.name.split(" ")[0]
        //   }`);
        // timeDelay(successContainer, successElement);
      }

      logoutButton.addEventListener("click", () => {
        localStorage.removeItem("loggedUser");
        (successContainer.style.display = "flex"),
          (successElement.innerHTML = "Logged out successfully");
        timeDelay(successContainer, successElement);
        window.location.href = "../index.html";
      });
    </script>

    <script>
      const displayBlogs = document.getElementById("totalArticles")
      const displayMessages = document.getElementById("totalMessages")
      const displayUsers = document.getElementById("totalUsers")
      const displayLikes = document.getElementById("totalLikes")
      let allBlogs = JSON.parse(localStorage.getItem("articles"));
      let blogContainer = document.getElementById(
        "dashboard-blog-container-map"
      );

      const setBlogLength =(length)=>{
        displayBlogs.innerText= length;
      }
      const setMessageLength =(length)=>{
        displayMessages.innerText= length || 0;
      }
      const setUserLength =(length)=>{
        displayUsers.innerText= length || 0;
      }
      const setLikeLength =(length)=>{
        displayLikes.innerText= length || 0;
      }

      const showBlogs = (blogs) => {
        blogContainer.innerHTML = "";
        blogs.reverse().map((blog, index) => {
          if (index < 3) {
            const card = document.createElement("a");
            card.classList.add("dashboard-blog-container-card");
            card.href = `./dashboard-single-blog.html?index=${blog._id}`;

            const img = document.createElement("img");
            img.src = blog.poster;
            img.style.objectFit = "cover";
            img.alt = "Blog Image";
            img.classList.add("blog-card-image");
            card.appendChild(img);

            const details = document.createElement("div");
            details.classList.add("blog-card-details", "blog-card-details");
            details.style.display = "flex";
            details.style.width = "100%";
            details.style.flexDirection = "column";

            const title = document.createElement("p");
            title.classList.add(
              "small-text",
              "title",
              "blog-title",
              "white-text"
            );
            title.innerText = blog.title;
            details.appendChild(title);

            const viewsLikesComments = document.createElement("div");
            details.classList.add("views-likes-comments");

            viewsLikesComments.innerHTML = `
                    <div class="views-likes-comments">
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/eye.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">${"10"} views</p>
                      </div>
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/heart.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">${"10"} likes</p>
                      </div>
                      <div class="like">
                        <img
                          src="../assets//images//dashboard-icons/comment.svg"
                          alt=""
                        />
                        <p class="light-text smaller-text">${"10"} comments</p>
                      </div>
                    </div>
                    `;
            details.appendChild(viewsLikesComments);
            card.appendChild(details);
            // card.appendChild(details)

            blogContainer.appendChild(card);
          }
        });
      };
console.log("myHeader", myHeaders)
      fetch(`http://localhost:8080/blogs`)
        .then((response) => response.json())
        .then((data) => {
          APIBlogs = data; // Assign the fetched data to the variable
          
          setBlogLength(data.length)
          showBlogs(data);
        })
        .catch((error) => {
          console.error("Error fetching data:", error);
        });

        // set messages
        fetch(`http://localhost:8080/messages`, {
          method:"GET",
          headers:myHeaders
        })
        .then((response) => response.json())
        .then((data) => {
          setMessageLength(data.length)
        })
        .catch((error) => {
          console.error("Error fetching data:", error);
        });

        // set users
        fetch(`http://localhost:8080/users`, {
          method:"GET",
          headers: myHeaders
        })
        .then((response) => response.json())
        .then((data) => {
          console.log("users", data);
          setUserLength(data.length)
        })
        .catch((error) => {
          console.error("Error fetching data:", error);
        });

        // set messages
        fetch(`http://localhost:8080/likes`)
        .then((response) => response.json())
        .then((data) => {
          console.log("likes", data);
          setLikeLength(data.length)
        })
        .catch((error) => {
          console.error("Error fetching data:", error);
        });

    </script>
    <script src="../Js/theme.js"></script>
  </body>
</html>
